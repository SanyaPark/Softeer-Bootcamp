# 🌅 하루 감상

고집부리지 말자 '이것만 되면!' 은 존재하지 않는다 그런거 보통 안 된다.
모른 채로 안되는 건 해 봐야 안 된다.
물어보고 찾아보고 해서 어떻게든 **'되는 거'** 하나 얻고 그걸 이해하는 것 부터 시작하는게 중요하다.
'하다 보면 되겠지'가 아니라 **거인의 어깨에 탑승하기**.
스스로 해 보는 것도 나쁜게 아니지만 **한정된 시간 안에서 안 되는것에 얼마나 시간을 쓸 수 있는지**도 생각하자.
결국 팀원들 도움을 받아서 어찌저찌 미션 2의 초반까지 성공했다.

이렇게 되는거 하나를 잡고 일부분을 빼 보고, 수정해보고 하면서 어떤 영향을 주고받는지도 어느정도 알 수 있었다.
**작은 실마리를 잡으면 거기서부터 쭉쭉 치고 올라갈 수 있다.**
되는거 하나는 그 작은 실마리를 제공해 주니 적극적으로 물어보자. 

gpt에게는 긴 코드는 기대하면 안된다. 얘가 좀 길게 짜주는거 되는 걸 본 적이 없다.


## 📚 배운 것
docker-compose 파일로 1 딸깍에 여러 컨테이너를 생성하는게 정말 편리하다.
찾아본 블로그 대부분이 컨테이너 간 통신을 위해 ssh 연결을 dockerfile에서 설정하는데, <br>
수민님 파일은 ssh 연결이 없었다. 
docker-compose 파일의 networks 설정에 의해 hadoop-network 내부에서 모든 컨테이너가 서로의 포트를 직접 접근 가능하게 된다.
--> Hadoop의 RPC 프로토콜은 SSH 없이도 네트워크 상의 노드 간 통신을 지원합니다. 라고 하더라
그럼 호스트는 어떻게 접근하나? 싶어 추가로 물어보니

**컨테이너 간 통신**
- NameNode가 DataNode들과 직접 통신합니다.
- 예를 들어, NameNode가 DataNode에 블록을 분배하거나, DataNode가 상태를 보고할 때 expose로 노출된 포트를 사용합니다.
**호스트에서 접근**
- DataNode의 웹 UI는 접근할 수 없지만, NameNode의 웹 UI에 접근하려면 ports를 사용하거나, 네트워크 브리지를 통해 터널링을 설정할 수 있습니다.
  - 이 터널링이란 것에 대해 더 자세히 알아보는것을 오늘의 숙제로 하겠다.

**추가적인 설명**
>현대적인 컨테이너 환경에서는 SSH가 꼭 필요한가?
(a) Docker Networking과 대체 통신
- Docker의 네트워킹 기능(bridge, overlay)을 활용하면 SSH 없이도 노드 간 통신이 가능합니다. <br>Hadoop 데몬 간의 RPC 통신은 별도의 SSH 연결 없이도 작동합니다.

(b) 컨테이너 환경에서 SSH의 대안
- 클러스터 관리 스크립트(start-dfs.sh, start-yarn.sh)는 도커 네트워크와 docker exec 명령으로 충분히 대체할 수 있습니다.
  - 그렇다면, 저 스크립트 실행 명령을 docker-compose나 entry.sh 같은 쉘 파일에 넣어도 된다는 말로 들린다... 맞나?
- SSH 대신 컨테이너 간 호스트네임과 포트로 Hadoop 노드 간 통신을 설정하는 방식이 더 간단합니다.

위 내용이 전부 사실이라면 오늘 하루종일 한 것들 중 상당부분이 큰 의미가 없던 것이 될 수도 있다...
특히 ssh를 사용하는 이유 중 하나가 디버깅 및 모니터링이라고 했는데 tty를 사용하면 되는게 아닌가 싶어 물어보니
```yaml
datanode1:
    image: vs/sftr:hadoop_v2.0
    tty: true
    stdin_open: true
```
이렇게 하면 ```docker exec -it <container_name> bash```로 내부 접속, <br>
```hdfs dfsadmin -report```, ```yarn node -list```같은 내부 명령으로 디버깅 할 수 있다고 한다.
애초에 당장 모니터링 자체는 Web UI로 보는게 더 편하다...

이래서 혼자 하지 말라는거지... 혼자 계속 했으면 ssh가 없어도 된다는 것을 몰라(참고한 자료들 죄다 ssh 연결하더라...) 불필요한 시도들만 하다가 이만큼도 못했을거다.

---

### 💾 Keep
모르면 바로 물어보기
다른팀과 정보공유 (이번엔 내가 받기만 하고 있긴 한데...)
어떻게든 되는거 하나 얻어서 거기부터 시작하기

### Try
하둡 내부 구조가 잘 이해가 안 되어 피상적인 마사지만 하는 느김
--> 각 노드에 대한 기능, 역할, 통신 이해 하기
일단 루트 유저로 하는데, 사실 이건 보안 측면에서 좋진 않은 방법같다.
--> 루트로 다 하고 유저 설정해서 다시 해 보는걸로